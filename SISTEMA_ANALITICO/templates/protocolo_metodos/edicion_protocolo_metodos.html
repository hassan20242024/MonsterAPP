{% extends "protocolo_metodos/base_crear_protocolo_metodos.html" %}
{% block contenido %}
{% load bootstrap5 %}
{% load crispy_forms_tags %}
{% load static %}

<link href="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/css/select2.min.css" rel="stylesheet" />
<script src="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/js/select2.min.js"></script>
<!--Advanced multiselect esasy-->
<link href="https://www.jqueryscript.net/demo/advanced-multiselect-easy/easySelectStyle.css" rel="stylesheet" />
<script src="https://www.jqueryscript.net/demo/advanced-multiselect-easy/easySelect.js"></script>
  <div class="container-fluid">
    <div class="card-body"><br>
      <h4 class="">Edición de protocolos</h4>
    </div>
    <div class="row">
        <!---------------------------------------Inicio Columna 1------------------------------------------------------>
      <div class="col-md-6">
        <div class="card">
          <div class="card-header">
            <h1 class="card-title">Editar protocolos</h1>
            <div class="card-tools">
              <button type="button" class="btn btn-tool" data-card-widget="collapse"><i class="fas fa-minus"></i></button>
              <button type="button" class="btn btn-tool" data-card-widget="remove"><i class="fas fa-remove"></i></button>
            </div>
          </div>
          <div class="card-body">
            <form action="" id="myModelForm" method="POST">
              {% csrf_token %}
              {{ form.fecha_ingreso|as_crispy_field  }}
              {{ form.codigo|as_crispy_field  }}
              {{ form.nombre|as_crispy_field  }}
              {{ form.cliente|as_crispy_field  }}
              {{ form.ensayo|as_crispy_field  }}
              {{ form.metodologia|as_crispy_field  }}
              {{ form.celda|as_crispy_field  }}

          </div>
        </div>
      </div>
      <!---------------------------------------------Inicio Columna 2------------------------------------------------------>
      <div class="col-md-6">
        <div class="card">
          <div class="card-header">
            <h1 class="card-title">Editar protocolos</h1>
            <div class="card-tools">
              <button type="button" class="btn btn-tool" data-card-widget="collapse"><i class="fas fa-minus"></i></button>
              <button type="button" class="btn btn-tool" data-card-widget="remove"><i class="fas fa-remove"></i></button>
            </div>
          </div>
          <div class="card-body">
            {{ form.parametro|as_crispy_field  }}
            {{ form.metodo|as_crispy_field  }}
            {{ form.Insumos_del_Proceso|as_crispy_field  }}
            {{ form.estado_protocolo|as_crispy_field  }}
            {{ form.observaciones|as_crispy_field  }}
            <div id="div_id_fecha_final" class="mb-3">
              <label for="id_fecha_final" class="form-label requiredField">
                  Fecha del estado<span class="asteriskField">*</span>
              </label>
            <input type="date" name="fecha_final" class="numberinput form-control" required id="id_fecha_final">
          </div>
        </div>
      </div>
    </div>
    <div class="container-fluid">
      <div class="card">
        <div class="card-body">
          {{ form.muestras_y_Placebos|as_crispy_field  }}
        </div>
  
       </div>
     </div>
      <div class=""><input type='submit' onclick='confirmar(event)' name='reservar' id='reservar' style="background-color: #1b3d70c2;" value="GUARDAR CAMBIOS" class="btn btn-primary btn-block" /></div><br><br>
      <div><a href="{% url 'adm_inicio' %}" onclick='salir(event)' class="btn btn-dark btn-block" style="background-color: #7d848ec2;" >CANCELAR</a>


  </div>
</form>
   
  {% block scripts %}
  <script>
    $("#id_muestras_y_Placebos").select2({
theme: "bootstrap-5",
placeholder: "Seleccione",

});
    $("#id_ensayo").select2({
theme: "bootstrap-5",
placeholder: "Seleccione",

});
$("#id_cliente").select2({
theme: "bootstrap-5",
placeholder: "Seleccione",
});
  </script>
<script> 
$(document).ready(function() {
$('#id_parametro').css('width', '100%').multiselect(
{
enableFiltering: true,
filterBehavior: 'text',
buttonWidth: '100%',
enableClickableOptGroups: true,
enableCollapsibleOptGroups: true,
nonSelectedText: 'Seleccionar Parametros',
enableCaseInsensitiveFiltering: true,
includeSelectAllOption: true,
maxHeight: 300
}
);
});
</script>


 <!-- Validación de campos -->
<script>
  function confirmar(event) { 
    let x = document.forms["myModelForm"]["fecha_final"].value;
 if (x == "") {
 
alert("Se requiere fecha final del estado");
 e.preventDefault();
   } 
    event.preventDefault();
    Swal.fire({
  title: "Está seguro?",
  text: "Por favor, confirme la edición del protocolo!",
  icon: "question",
  showCancelButton: true,
  confirmButtonColor: "#3085d6",
  cancelButtonColor: "#d33",
  confirmButtonText: "Editar!"
    }).then((result) => {
        if (result.isConfirmed) {
          document.getElementById('myModelForm').submit();
        }
    })
}
</script>
<script>
  function salir(event) { 
    
    event.preventDefault();
    Swal.fire({
  title: "Desea salir?",
  text: "Tu información no será guardada!",
  icon: "warning",
  showCancelButton: true,
  confirmButtonColor: "#3085d6",
  cancelButtonColor: "#d33",
  confirmButtonText: "Confirmar",
  cancelButtonText: "Cancelar"
}).then((result) => {
        if (result.isConfirmed) {
          window.location.href = '/adm_inicio'
        }
    })
}
</script>
  <!-- validacion de campos-->

   {% endblock scripts %}
   <!--
     <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.0/jquery.min.js"></script>
   -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-multiselect/0.9.13/js/bootstrap-multiselect.js"></script>
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-multiselect/0.9.13/css/bootstrap-multiselect.css" rel="stylesheet"/>
  {% endblock contenido %}
